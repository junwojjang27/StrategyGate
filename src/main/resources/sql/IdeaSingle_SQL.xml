<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="system.menu.ideaSingle">
	<select id="selectList" parameterType="ideaSingleVO" resultType="ideaSingleVO">
		/*	간단제안 조회	system.menu.ideaSingle.selectList */
		SELECT
			A.IDEA_CD,
			A.YEAR,
			A.USER_ID,
			A.CATEGORY,
			A.TITLE,
			A.CONTENT,
			A.STATE,
			<!--CREATE_DT,-->
			TO_CHAR(A.CREATE_DT, 'YYYY.MM.DD') AS CREATE_DT,
			A.UPDATE_DT,
			A.DELETE_DT,
			A.START_DT,
			A.END_DT,
			A.ATCH_FILE_ID,
			A.IDEA_GBN_CD,
			A.DEGREE,
			A.EVAL_STATE,
			B.USER_NM,
			B.DEPT_NM
		FROM IDEA_INFO A
		LEFT JOIN V_ROLE_USER B
		ON A.USER_ID = B.USER_ID
		WHERE A.IDEA_GBN_CD = '001'
			<if test='findUseYn != null and findUseYn == "Y"'>
				AND A.DELETE_DT IS NULL
			</if>
			<if test='findUseYn != null and findUseYn == "N"'>
				AND A.DELETE_DT IS NOT NULL
			</if>


	</select>
	
	<select id="selectDetail" parameterType="ideaSingleVO" resultType="ideaSingleVO">
		/*	간단제안 상세 조회	 	system.menu.ideaSingle.selectDetail	*/
		SELECT
			<!--IDEA_CD,
			YEAR,
			USER_ID,
			CATEGORY,
			TITLE,
			CONTENT,
			STATE,
			CREATE_DT,
			UPDATE_DT,
			DELETE_DT,
			START_DT,
			END_DT,
			ATCH_FILE_ID,
			IDEA_GBN_CD,
			DEGREE,
			EVAL_STATE
		FROM IDEA_INFO-->
		A.CATEGORY,
		A.TITLE,
		A.CONTENT
		FROM IDEA_INFO A
		WHERE 1=1
			<!--AND IDEA_CD=#{ideaCd}
			AND YEAR=#{year}
			AND CREATE_DT=#{createDt}-->
			AND A.IDEA_CD=#{ideaCd}
			AND A.YEAR=#{findYear}

	</select>	
	
	<!-- 
	<update id="updateSortOrder" parameterType="ideaSingleVO">
	    /*	간단제안 정렬순서저장	 ideaSingle.updateSortOrder	*/
		updateSortOrderQuery
	</update>
	-->
	
	<update id="deleteIdeaSingle" parameterType="ideaSingleVO">
		/*	간단제안 삭제	system.menu.ideaSingle.deleteIdeaSingle	*/
		UPDATE IDEA_INFO A
		SET
			A.DELETE_DT = SYSDATE
		WHERE A.YEAR = #{findYear}
			AND A.IDEA_CD IN
			<foreach collection="keys" item="key" open="(" close=")" separator=",">
				#{key}
			</foreach>
			<!--DELETE_DT = SYSDATE
		WHERE 1=1
			AND IDEA_CD=#{ideaCd}
			AND YEAR=#{year}
			AND CREATE_DT=#{createDt}-->

	</update>

	<insert id="insertData" parameterType="ideaSingleVO">
		/*	간단제안 저장	system.menu.ideaSingle.insertData	*/
		INSERT INTO IDEA_INFO(
			IDEA_CD,
			YEAR,
			USER_ID,
			CATEGORY,
			TITLE,
			CONTENT,
			STATE,
			CREATE_DT,
			UPDATE_DT,
			DELETE_DT,
			START_DT,
			END_DT,
			ATCH_FILE_ID,
			IDEA_GBN_CD,
			DEGREE,
			EVAL_STATE)
		
VALUES (
			#{ideaCd},
			#{year},
			#{userId},
			#{category},
			#{title},
			#{content},
			#{state},
			SYSDATE,
			#{updateDt},
			#{deleteDt},
			#{startDt},
			#{endDt},
			#{atchFileId},
			'001',
			#{degree},
			#{evalState})

	</insert>

	<update id="updateData" parameterType="ideaSingleVO">
		/*	간단제안 수정	system.menu.ideaSingle.updateData	*/
		UPDATE IDEA_INFO
		SET
			<!--USER_ID=#{userId},
			CATEGORY=#{category},
			TITLE=#{title},
			CONTENT=#{content},
			STATE=#{state},
			UPDATE_DT=#{updateDt},
			DELETE_DT=#{deleteDt},
			START_DT=#{startDt},
			END_DT=#{endDt},
			ATCH_FILE_ID=#{atchFileId},
			IDEA_GBN_CD=#{ideaGbnCd},
			DEGREE=#{degree},
			EVAL_STATE=#{evalState}-->
			YEAR = #{findYear},
			CATEGORY=#{category},
			TITLE=#{title},
			CONTENT=#{content},
		WHERE 1=1
			AND IDEA_CD=#{ideaCd}
			AND YEAR=#{findYear}

	</update>
</mapper>

